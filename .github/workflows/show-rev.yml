name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions ðŸš€
on: 
  - pull_request
  - push

jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
      - run: jq . ${GITHUB_EVENT_PATH}
      - run: |
          import os
          import json
          import re

          event_path = os.environ['GITHUB_EVENT_PATH']
          with open(event_path, "r") as f:
            event = json.load(f)
          
          file_path = "/file.md"
          def get_edit_url():
            if (pull_request := event.get("pull_request")):
              pr_repo_name = pull_request['head']['repo']['full_name']
              pr_branch_name = pull_request['head']['ref']

              # If we're a fork, pr_repo_name won't match the source repo
              return f"https://github.com/{pr_repo_name}/edit/{pr_branch_name}{file_path}"
            elif "commits" in event:
              ref = event['ref']

              if (match := re.match("^refs/heads/(.*)$", ref)): 
                repo_name = event['repository']['full_name']
                branch_name = match[1]
                return f"https://github.com/{repo_name}/edit/{branch_name}{file_path}"

          print(get_edit_url())



        shell: python
